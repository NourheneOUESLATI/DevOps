pipeline {
      agent any
   stages{
         stage('clean'){
           steps{
             sh "mvn clean"
           }
         }
         stage('packaging'){
           steps{
             sh "mvn package"
           }
         }
         stage('compile'){
           steps{
            sh "mvn compile"
           }
         }
         stage('test'){
           steps{
             sh "mvn test"
           }
         }         
         stage('Sonar'){
           steps{
            sh "mvn sonar:sonar   -Dsonar.host.url=http://localhost:9000 -Dsonar.login=38cb8ff3cd6480dc7027341b56e250520f7cbbc4"
           }
         }
         stage('nexus'){
           steps{
             sh "mvn clean package deploy:deploy-file -Dmaven.test.skip=true -DgroupId=tn.esprit.spring -DartifactId=DevOps--5SE4 -Dversion=1.0.2 -DgeneratePom=true -Dpackaging=jar -DrepositoryId=deploymentRepo -Durl=http://localhost:8081/repository/maven-releases/ -Dfile=target/DevOps--5SE4-1.0.2.jar"
           }
         }
         
         
       }
     post {
       success {
         emailext body: 'build success', subject: 'jenkins', to: 'm.khalil.manai@gmail.com'
       }
       failure {
         emailext body: 'failure', subject: 'jenkins', to: 'm.khalil.manai@gmail.com'
       }
     }
 }
         
         