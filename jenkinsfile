pipeline {
     agent any
   stages{
   stage('Unit Test'){
              steps{
                bat """mvn test"""
              }

         stage('Build Package'){
           steps{
             bat """mvn clean install"""
           }
         }

         stage('Code Quality Test'){
           steps{
             bat """mvn sonar:sonar"""
           }
         }
         stage('Deploying New Package'){
           steps{
             bat """mvn clean package deploy:deploy-file -Dmaven.test.skip=true -DgroupId=tn.esprit.spring -DartifactId=DevOps--5SE4 -Dversion=1.0.14 -DgeneratePom=true -Dpackaging=jar -DrepositoryId=deploymentRepo -Durl=http://localhost:8081/repository/maven-releases/ -Dfile=target/DevOps--5SE4-1.0.14.jar"""
           }
         }
     }
     post {
       success {
         emailext body: 'build success', subject: 'jenkins', to: 'mohamedali.znidi1@esprit.tn'
       }
       failure {
         emailext body: 'build failure', subject: 'jenkins', to: 'mohamedali.znidi1@esprit.tn'
       }
     }
     }
 }
         
         